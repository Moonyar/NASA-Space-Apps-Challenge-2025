
<!doctype html>
<html>
  <head>
    <style>
      .loading { display: none; }
      .error { color: red; }
      .success { color: green; }
    </style>
  </head>
  <body>
    <h2>Review & Confirm</h2>
    <p><strong>Dataset:</strong> {{ dataset }}</p>
    <p><strong>Dataset URI:</strong> {{ dataset_uri }}</p>
    <p><strong>Model:</strong> {{ model }}</p>
    <p><strong>Target:</strong> {{ target_col }}</p>
    <p><strong>Features ({{ feature_cols|length }}):</strong> {{ feature_cols|join(", ") }}</p>
    <h3>Hyperparameters</h3>
    <pre>{{ params | tojson(indent=2) }}</pre>
    
    <div id="status"></div>
    <button id="trainBtn" onclick="trainModel()">üöÄ Train Model</button>
    <div class="loading" id="loading">Training in progress... Please wait.</div>
    <p><a href="/">‚Üê Start over</a></p>

    <script>
      async function trainModel() {
        const btn = document.getElementById('trainBtn');
        const loading = document.getElementById('loading');
        const status = document.getElementById('status');
        
        btn.disabled = true;
        loading.style.display = 'block';
        status.innerHTML = '';
        
        try {
          const response = await fetch('/train', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'}
          });
          
          const data = await response.json();
          
          if (data.success) {
            status.innerHTML = '<p class="success">‚úì Training completed successfully!</p>';
            setTimeout(() => {
              window.location.href = '/results';
            }, 1000);
          } else {
            status.innerHTML = `<p class="error">Error: ${data.error}</p>`;
            btn.disabled = false;
          }
        } catch (error) {
          status.innerHTML = `<p class="error">Error: ${error.message}</p>`;
          btn.disabled = false;
        } finally {
          loading.style.display = 'none';
        }
      }
    </script>
  </body>
</html>